
<div class="container-fluid mt-4">
  <div class="container">
    <div class="container">
      <div class="card">
        <div class="card-header text-center bg-dark">
          <h2 style="color:white">{{title}}</h2>
        </div>
        <div class="card-body">
          <!--Profile Image will be default if image hasn't been taken or selected. Once image capture it will replace default image-->
          <div class=" text-center">
            <img *ngIf ="profile.profileImage" [src]="profile.profileImage" width="125px" height="125px" alt="Profile Image" class="img-fluid rounded-circle profile">
            <img *ngIf ="!profile.profileImage" src="assets/img/profileIcon.png" width="125px" height="125px" alt="Profile Image" class="img-fluid rounded-circle profile">
          </div>
          <h4 class="mt-2 text-center" style="color:steelblue">Your Information</h4>
          <form #profileForm="ngForm" class="row g-3">
            <div class="mb-3">
              <div class="row">
                <div class="col">
                  <label class="mb-2" for="txtFirstName"></label>
                  <input type="text" class="form-control" placeholder="First name" aria-label="txtFirstName" id="txtFirstName" name="txtFirstName"
                         [(ngModel)]="profile.firstName" #firstName="ngModel"
                         required [minlength] = "MIN_LENGTH">
                  @if (firstName.invalid && (firstName.touched || firstName.dirty)){
                    @if(firstName.errors?.['required']){
                      <small class="text-danger">Your First name is required</small><br>
                    }
                    @if (firstName.errors?. ['minlength']){
                      <small class="text-danger">Your First name must be at least {{MIN_LENGTH}} characters long</small><br>
                    }
                  }
                </div>
                <div class="col">
                  <label class="mb-2" for="txtLastName"></label>
                  <input type="text" class="form-control" placeholder="Last name" aria-label="txtLastName" id="txtLastName" name="txtLastName"
                         [(ngModel)]="profile.lastName" #lastName="ngModel"
                         required [minlength] = "MIN_LENGTH"/>
                  @if (lastName.invalid && (lastName.touched || lastName.dirty)){
                    @if(lastName.errors?.['required']){
                      <small class="text-danger">Your Last name is required</small><br>
                    }
                    @if (lastName.errors?. ['minlength']){
                      <small class="text-danger">Your Last name must be at least {{MIN_LENGTH}} characters long</small><br>
                    }
                  }
                </div>
              </div>
            </div>
            <div class="mb-3">
              <div class="row">
            <div class="col">
              <label class="mb-2" for="txtPhoneNumber"></label>
              <input id="txtPhoneNumber" type="text" class="form-control" placeholder="Phone number" name="txtPhoneNumber" [(ngModel)]="profile.phoneNumber"
                     #phoneNumber="ngModel"
                   pattern="^[0-9]{3}[-\s]{0,1}[0-9]{3}[-\s]{0,1}[0-9]{4}$" required/>
              @if (phoneNumber.invalid && (phoneNumber.touched || phoneNumber.dirty)){
                @if(phoneNumber.errors?.['required']){
                  <small class="text-danger">Your phone number is required</small><br>
                }
                @if(phoneNumber.errors?.['pattern']){
                  <small class="text-danger">Invalid phone number format</small><br>
                }
              }
            </div>
            <div class="col">
            <label for="txtEmail" class="form-label"></label>
            <input id="txtEmail" type="text" class="form-control" placeholder="Email address" name="txtEmail" [(ngModel)]="profile.email" #email="ngModel"
                   required pattern="^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}[\s]{0,1}$"/>
            @if (email.invalid && (email.touched || email.dirty)){
              @if(email.errors?.['required']){
                <small class="text-danger">Your email address is required</small><br>
              }
              @if(email.errors?.['pattern']){
                <small class="text-danger">Invalid email address format</small><br>
              }
            }
          </div>
              </div>
            </div>
            <!--Entering your address is optional-->
            <div class="col-12">
              <label for="txtAddress" class="form-label"></label>
              <input type="text" class="form-control" id="txtAddress" placeholder="Address" name="txtAddress" [(ngModel)]="profile.address">
            </div>
            <div class="col-md-6">
              <label for="txtCity" class="form-label"></label>
              <input type="text" class="form-control" id="txtCity" placeholder="City" name="txtCity" [(ngModel)]="profile.city" #city="ngModel"
                     pattern="^[A-Za-z ]*$"/>
              @if (city.invalid && (city.touched || city.dirty)){
                @if(city.errors?.['pattern']){
                  <small class="text-danger">Please enter text only, numbers not accepted </small><br>
                }
              }
            </div>
            <div class="col-md-4">
              <label for="txtProvince" class="form-label"></label>
              <input type="text" class="form-control" id="txtProvince" placeholder="Province" name="txtProvince" [(ngModel)]="profile.province"
                     #province="ngModel"
                     pattern="^[A-Za-z]*$"/>
              @if (province.invalid && (province.touched || province.dirty)){
                @if(province.errors?.['pattern']){
                  <small class="text-danger">Please enter text only, numbers not accepted </small><br>
                }
              }
            </div>
            <div class="col-md-2">
              <label for="inputPostalCode" class="form-label"></label>
              <input type="text" class="form-control" id="inputPostalCode" placeholder="Postal Code" name="txtPostalCode" [(ngModel)]="profile.postalCode"
                     #postalCode="ngModel"
                    pattern="^[A-Za-z]{1}[0-9]{1}[A-Za-z]{1}[-\s]{0,1}[0-9]{1}[A-Za-z]{1}[0-9]{1}$"/>
              @if (postalCode.invalid && (postalCode.touched || postalCode.dirty)){
                @if(postalCode.errors?.['pattern']){
                  <small class="text-danger">Please enter a valid postal code format </small><br>
                }
              }
            </div>
            <h4 class="mt-4 text-center" style="color:steelblue">Username & Profile Picture</h4>
            <div class="col-md-4">
              <div class="input-group mb-3">
              <div class="input-group-text">&#64;</div>
              <label for="txtUsername" class="form-label"></label>
              <input id="txtUsername" type="text" class="form-control" placeholder="Username" name="txtUsername"  [(ngModel)]="profile.username">
            </div>
            </div>

            <!--Camera Functions -->
            <div class="mb-3">
              <div class="row">
                <div class="col">
                  <button class=" btn btn-primary container-fluid"  (click)="onCapturePhotoClick()">Capture photo</button>
                  <div class="m-3"></div>
                </div>
                <div class="col">
                  <button class=" btn btn-dark container-fluid" (click)="onLoadFromLibraryClick()">Camera Roll</button>
                </div>
              </div>
            </div>

            <div class="mt-3 d-flex justify-content-center">
              <button type="submit" [disabled]="profileForm.invalid" id="btnBook" class="btn btn-success btn-lg"
                      (click)="onProfileClick(); profileForm.reset()" style="width: 300px;">Create Profile</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
